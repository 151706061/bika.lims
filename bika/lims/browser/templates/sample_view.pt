<html xmlns="http://www.w3.org/1999/xhtml"
    xml:lang="en" lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    metal:use-macro="here/main_template/macros/master"
    i18n:domain="bika">

<body>

<metal:title fill-slot="content-title">
    <h1 tal:content="here/title_or_id"/>
</metal:title>

<metal:content fill-slot="content-core" tal:define="
    review_state python:context.portal_workflow.getInfoFor(here, 'review_state', '');
    inactive_review_state python:context.portal_workflow.getInfoFor(context, 'inactive_review_state', 'asdf');
    lab_accredited python:context.bika_setup.laboratory.getLaboratoryAccredited();
    portal context/@@plone_portal_state/portal;
    sampletype here/getSampleType;">

    <table width="100%">
        <tr>
            <td align="right">
                <img tal:condition="sampletype/getHazardous"
                    title="Hazardous"
                    tal:attributes="src string:++resource++bika.lims.images/hazardous.png">
            </td>
        </tr>
    </table>

    <table
        summary="Sample view"
        class="analysisrequest listing nosort"
        cellpadding="0" cellspacing="0">
    <thead>

        <tr>
            <th i18n:translate="label_clientreference">Client Reference</th>
            <td class="left" tal:content="here/getClientReference">R001</td>
        </tr>

        <tr>
            <th i18n:translate="label_clientsampleid">Client Sample ID</th>
            <td class="left" tal:content="here/getClientSampleID">S001</td>
        </tr>

        <tr>
            <th i18n:translate="label_requests">Requests</th>
            <td class="left">
                <tal:requests
                    tal:define="ars python:here.getAnalysisRequests()"
                    tal:repeat="ar ars">
                    <a tal:content="ar/Title" tal:attributes="href ar/absolute_url">AR-00001</a>
                </tal:requests>
            </td>
        </tr>

        <tr>
            <th i18n:translate="label_sampletype">Sample type</th>
            <td class="left" tal:content="sampletype/Title|nothing">sample type</td>
        </tr>

        <tr>
            <th i18n:translate="label_samplepoint">Sample point</th>
            <td class="left"
                tal:define="samplepoint here/getSamplePoint"
                tal:content="samplepoint/Title|nothing">sample point</td>
        </tr>

        <tr>
            <th i18n:translate="label_hazardous">Hazardous</th>
            <td class="left"
                tal:content="sampletype/getHazardous">False</td>
        </tr>

        <tr>
            <th i18n:translate="label_datesampled">Date sampled</th>
            <td class="left">
                <span
                    tal:define="date_sampled here/getDateSampled"
                    tal:condition="date_sampled"
                    tal:content="python:plone_view.toLocalizedTime(date_sampled, long_format=0)"/>
            </td>
        </tr>

        <tr>
            <th i18n:translate="label_datesubmitted">Date submitted</th>
            <td class="left">
                <span
                    tal:define="date_submitted here/getDateSubmitted"
                    tal:condition="date_submitted"
                    tal:content="python:plone_view.toLocalizedTime(date_submitted, long_format=1)"/>
            </td>
        </tr>

        <tr tal:condition="python:review_state != 'due'">
            <th i18n:translate="label_datereceived">Date received</th>
            <td class="left">
                <span
                    tal:define="date_received here/getDateReceived"
                    tal:condition="date_received"
                    tal:content="python:plone_view.toLocalizedTime(date_received, long_format=1)"/>
            </td>
        </tr>

        <tr>
            <th i18n:translate="label_disposal_date">Disposal date</th>
            <td class="left">
                <span
                    tal:define="disposal_date here/getDisposalDate"
                    tal:condition="disposal_date"
                    tal:content="python:plone_view.toLocalizedTime(disposal_date, long_format=1)"/>
            </td>
        </tr>

        <tr tal:condition="python:review_state in ['expired', 'disposed']">
            <th i18n:translate="label_dateexpired">Date expired</th>
            <td class="left">
                <span
                    tal:define="date_expired here/getDateExpired"
                    tal:condition="date_expired"
                    tal:content="python:plone_view.toLocalizedTime(date_expired, long_format=1)"/>
            </td>
        </tr>

    </thead>
    </table>

    <form action="workflow_action">
        <input
            tal:condition="python:inactive_review_state == 'active'"
            class="context workflow_action_button"
            type="submit"
            value="deactivate"
            name="workflow_action">
        <input
            tal:condition="python:inactive_review_state == 'inactive'"
            class="context workflow_action_button"
            type="submit"
            value="activate"
            name="workflow_action">
    <form>

</metal:content>
</body>
</html>
