Bika LIMS Installation
----------------------

This document describes the installation of Bika LIMS 
using the Plone Unified Installer package.

### Download and install Plone

The latest Unified Installer can be found at
http://plone.org/products/plone/releases
Plone 4 or newer is required.  Plone 4.2.1 is the latest stable version tested.

### Install dependencies

The following commands are as used under Ubuntu 12.04.
Use package manner to install needed dependencies:
(apt-get is an acceptable to aptitude)

sudo aptitude install gcc
sudo aptitude install zlib1g-dev
sudo aptitude install libssl-dev
sudo aptitude install gnuplot
sudo aptitude install git-core

### Download and install Plone

Retrieve the unified installer, and run the installer script. The "dev"
branch is used in this example. Omit the "-b dev" argument to use the
master. Modify your directory if needed, "/home/bika" is used below.

wget https://launchpad.net/plone/4.2/4.2.1/+download/Plone-4.2.1-UnifiedInstaller.tgz 
tar xzf Plone-4.2.1-UnifiedInstaller.tgz 
cd Plone-4.2.1-UnifiedInstaller/
sudo ./install.sh --target=/home/bika standalone 

Visit http://plone.org/documentation/topic/Installation for more
information about setting up Plone if the step above fails.

### Change to the new instance directory

cd /home/bika/zinstance

At this point a plain Plone instance could be built and run. 
This is a good intermediary checkpoint in case of any system
issues or installation problems. Refer to http://Plone.org 
if this step fails.

### Option - Retrieve the development branch Github Bika code 

sudo git clone -b dev git://github.com/bikalabs/Bika-LIMS.git src/bika.lims

    Omit the command line switch '-b dev' to get the master branch instead.

### Edit Plone/zinstance/buildout.conf to add Bika LIMS.

Find the "eggs" section and add "bika.lims"

    eggs =
        ...
        bika.lims

### Option - Use latest source code
Find the "develop" section and add "src/bika.lims"

   develop = 
        src/bika.lims


Omitting this step will cause the latest Python egg from 
PYPI to be used instead of the Github code at
https://github.com/bikalabs/Bika-LIMS/tree/dev

### Run buildout

sudo bin/buildout

### Start Plone

    # Start in foreground (debug) mode, noting error
    # messages if any and taking corrective action

bin/plonectl fg

    # start normally:

bin/plonectl start

### Add a new Plone instance:

Assign an ID of your choice, and select the checkbox to activate the
Bika-LIMS extension profile.  To add Bika LIMS to an existing Plone site,
visit the Addons page of Site Setup.

IMPORTANT: Don't use "Bika" or "BIKA" as the instance name, this is a
reserved namespace. If you get "Site Error" "AttributeError: adapters",
this is the most likely cause of it.

### Removing the installed database and starting fresh

In case you need to start with a clean slate, (re)move the Data.fs files.
This will remove all Plone instances, and WILL DESTROY all entered data.
The code will not be affected.

sudo rm -f var/filestorage/*

In this case, or if you have problems loggin in, you might need to re-add
the admin user:

bin/plonectl adduser admin password

That's it!

### Visit the site in your Browser
You should be able to test the site now by visiting

http://localhost:8080/Plone
or 
http://admin:password@localhost:8080/Plone 

If you need to visit the ZMI, use

http://localhost:8080/manage

If no Plone object exists, add one and tick the "Bika LIMS" extension.
(Note that "Bika" may not work as an instance name, see above.)

You can edit the code in src/bika.lims and restart the instance to 
make the changes take effect. It should not affect the installed databases.
Changing the CSS does not require the instance to be restarted.

