<html>
<head>
<SCRIPT LANGUAGE="Javascript"><!-- 
    var total = 0;
    var heading = ' ';
    var footnote = ' ';
    function doProgressBar()
    { 
        if (heading == ' ') {
            heading = top.document.getElementById('progressType').value;
            document.getElementById('divProgressHeading').innerHTML = heading + ' in progress...';
        }

        if (total == 0) {
            total = top.document.getElementById('inputTotal').value;
        }
        setInterval("updateProgressBar()", 3000);
    }
    function updateProgressBar()
    { 

        var arr = top.document.getElementsByName('inputProgress');

        if (arr.length > 0)  {
            num = arr[arr.length-1].value;
        } else {
            num = 0;
        }

        document.getElementById('divProgressBar').style.width = num*1.0/total*300 + 'px';
        document.getElementById('divProgressText').innerHTML = '&nbsp;' + num + '/' + total + ' (' + (Math.floor(num*100.0/total)) + '%)';

        if (num == total) {
            if (footnote == ' ') {
                footnote = top.document.getElementById('progressDone').value;
            } else {
                footnote = 'Completed!'
            }
            document.getElementById('divProgressDone').innerHTML = footnote;
        }
            
    }
//--></SCRIPT>
</head>

<body onLoad="doProgressBar()" style="font-size: 11px;">
<form name="frm">
  <div id="divProgressHeading"></div>
  <div id="divProgressBar" style="float: left; width: 1px; height: 17px; background-color: blue;"></div>
  <div id="divProgressText"></div>
  <div style="clear: both;"></div>
  <div id="divProgressDone"></div>
</form>
</body>

</html>

