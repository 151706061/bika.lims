<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="bika">

<head>
    <metal:block fill-slot="top_slot"
                 tal:define="dummy python:request.set('disable_border', 1)" />

    <metal:calendar fill-slot="javascript_head_slot">
        <!-- ECMAScript calendar -->
        <style type="text/css" media="all"
            tal:content="string:@import url($portal_url/jscalendar/calendar-system.css);"></style>
        <script type="text/javascript"
            tal:attributes="src string:$portal_url/jscalendar/calendar_stripped.js"></script>
        <script type="text/javascript" charset="iso-8859-1"
            tal:condition="exists: portal/jscalendar/calendar-en.js"
            tal:attributes="src string:$portal_url/jscalendar/calendar-en.js"></script>
    </metal:calendar>

</head>
<body>
<div metal:fill-slot="main"
    tal:define="form_submitted request/submit|nothing">


<div metal:use-macro="here/document_actions/macros/document_actions">
Document actions (print, sendto etc)
</div>
<metal:block use-macro="here/report_analysestotals_print/macros/header"/>
<tal:parameters condition="not:form_submitted">

<form action="report_analysestotals_view" method="post" name="search">
<fieldset>

<legend i18n:translate="legend_selection_criteria">Selection criteria</legend>

<div class="field" tal:condition="not:here/member_is_client">
    <label i18n:translate="label_client"
        >Client</label><br/>
    <select name="getClientUID:ignore_empty" 
            style=""
            id="getClientUID"
            tal:attributes="style string:font-family:${here/base_properties/fontFamily};;font-size:100%;">
        <option value=""/>

        <tal:clients
            define="    
                clients python:here.portal_catalog(portal_type='Client');
                sort_on python:(('Title', 'nocase', 'asc'),);
                clients python:sequence.sort(clients, sort_on);"
            repeat="client clients">
        <option value=""
            tal:define="client_uid python:client.getObject().UID()"
            tal:attributes="value client_uid;
                selected python:request.get('getClientUID', '') == client_uid and 'selected' or ''"
            tal:content="client/Title"
            >Upfront Systems</option>

        </tal:clients>
    </select>
</div>

<div class="field">
    <label i18n:translate="label_daterequested"
        >Date requested</label><br/>
    <span i18n:translate="label_from">From</span>


    <tal:define define="
        id string:getDateRequested_fromdate;
        inputname id;
        formname string:search;
        value request/getDateRequested_fromdate | nothing;
        show_hm python:False;
        inputvalue python:test(value!='None', value, '');">
    <metal:use use-macro="here/calendar_macros/macros/calendarDatePickerBox">
        a calendar, hopefully
    </metal:use>
    </tal:define>

    <span i18n:translate="label_to">to</span>

    <tal:define define="
        id string:getDateRequested_todate;
        inputname id;
        formname string:search;
        value request/getDateRequested_todate | nothing;
        show_hm python:False;
        inputvalue python:test(value!='None', value, '');">
    <metal:use use-macro="here/calendar_macros/macros/calendarDatePickerBox">
        a calendar, hopefully
    </metal:use>
    </tal:define>

</div>

<div class="field">
    <label i18n:translate="label_datepublished"
        >Date published</label><br/>
    <span i18n:translate="label_from">From</span>


    <tal:define define="
        id string:getDatePublished_fromdate;
        inputname id;
        formname string:search;
        value request/getDatePublished_fromdate | nothing;
        show_hm python:False;
        inputvalue python:test(value!='None', value, '');">
    <metal:use use-macro="here/calendar_macros/macros/calendarDatePickerBox">
        a calendar, hopefully
    </metal:use>
    </tal:define>

    <span i18n:translate="label_to">to</span>

    <tal:define define="
        id string:getDatePublished_todate;
        inputname id;
        formname string:search;
        value request/getDatePublished_todate | nothing;
        show_hm python:False;
        inputvalue python:test(value!='None', value, '');">
    <metal:use use-macro="here/calendar_macros/macros/calendarDatePickerBox">
        a calendar, hopefully
    </metal:use>
    </tal:define>

</div>

<div class="field">
    <label i18n:translate="label_status"
        >Status</label><br/>
    <select name="review_state:ignore_empty" 
            style=""
            id="review_state">
        <option value=""/>
        <tal:states
            define="states here/analysis_workflow_states"
            tal:repeat="state states">
        <option value=""
            tal:attributes="value state/id;
                selected python:request.get('review_state', '') == state['id'] and 'selected' or ''"
            tal:content="state/title"
            >Sample received </option>
        </tal:states>
    </select>
</div>


<div class="field">
    <input tabindex=""
        class="searchButton"
        type="submit"
        name="submit"
        value="Search"
        i18n:attributes="value"
        />                       
</div>

</fieldset>
</form>
</tal:parameters>

<tal:results condition="form_submitted">
<metal:block use-macro="here/report_analysestotals_print/macros/subheader"/>
<br/>
<form name="report_analysestotals_print" action="." method="post">
<input type="hidden" name="getClientUID"
    tal:attributes="value python:request.get('getClientUID', None)">
<input type="hidden" name="getDateRequested_fromdate"
    tal:attributes="value python:request.get('getDateRequested_fromdate', None)">
<input type="hidden" name="getDateRequested_todate"
    tal:attributes="value python:request.get('getDateRequested_todate', None)">
<input type="hidden" name="review_state"
    tal:attributes="value python:request.get('review_state', None)">

<input
    class="printButton"
    type="submit"
    name="report_analysestotals_print:method"
    value="Print"
    tabindex=""
    i18n:attributes="value"
    tal:attributes="
        tabindex tabindex/next|nothing"/>
        
</form>
<metal:block use-macro="here/report_analysestotals_print/macros/body"/>
</tal:results>
</div>
</body>

</html>
