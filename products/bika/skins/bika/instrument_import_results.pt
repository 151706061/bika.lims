<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="bika">

<head>
    <metal:block fill-slot="top_slot"
       tal:define="dummy python:request.set('disable_border', 1)" />
</head>


<body>

<div metal:fill-slot="main">
<div metal:use-macro="here/document_actions/macros/document_actions">
Document actions (print, sendto etc)
</div>
<h1>
<tal:block replace="structure python:getattr(here, here.getIcon(1))"/>
<span i18n:translate="heading_import_results"
    >Imported instrument data results</span>
</h1>

<div
tal:define="
    instrument python:context.REQUEST.get('getInstrument');
    results_ids python:here.import_instrument(instrument);
    results results_ids/results;
    ids results_ids/ids;
    ">

<dl>
<tal:id 
    tal:repeat="id ids">
<dt tal:content="id"/>

<tal:analysis tal:define="analyses python:results[id]['analyses']"
    tal:condition="analyses">
<dd>
<span i18n:translate="label_analyses_updated">Analyses updated:</span>
<tal:item tal:repeat="analysis analyses">
<span tal:define="d_a python:repeat['analysis'].index > 0 and ', ' + analysis or analysis"
    tal:replace="d_a"/>
</tal:item>
</dd>
</tal:analysis>

<tal:add tal:define="addeds python:results[id]['added']"
    tal:condition="addeds">
<dd>
<span i18n:translate="label_analyses_added">Analyses added:</span>
<tal:item tal:repeat="added addeds">
<span tal:define="d_a python:repeat['added'].index > 0 and ', ' + added or added"
    tal:replace="d_a"/>
</tal:item>
</dd>
</tal:add>

<tal:fail tal:define="failures python:results[id]['errors']"
    tal:condition="failures">
<dd class="emphatic" tal:repeat="failure failures"
    tal:content="failure"/>
</tal:fail>

</tal:id>

</dl>
</div>
</div>

</body>
</html>

