<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      i18n:domain="bika">

<head tal:define="ztu modules/ZTUtils;">
    <title tal:content="here/title_or_id">Title or Id</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"
          tal:define="charset here/portal_properties/site_properties/default_charset;
                      dummy python:request.RESPONSE.setHeader('Content-Type', 'text/html;;charset=%s' % charset)"
          tal:attributes="content string:text/html;;charset=${charset}" />
    <tal:cssreg tal:condition="exists:here/portal_css">    
        <metal:css metal:use-macro="here/renderAllTheStylesheets/macros/cssrenderer">
             <!-- Fetch stylesheets from the CSS Registry -->
        </metal:css>
    </tal:cssreg>
    <style type="text/css" media="all" 
           tal:condition="not: exists:here/portal_css"
           tal:define="current_skin python: request.get(here.portal_skins.getRequestVarname(),'');
           skin_query python:(current_skin and ('?' + ztu.make_query(skin=current_skin))) or ''"
           tal:content="string: @import url(${here/portal_url}/plone.css${skin_query});">
    </style>
<style>
table {
    border-collapse:collapse;
    margin: 1px 0em 1px 0em;
}
tr {
    page-break-inside: avoid;
}
th {
    border: 1px solid Black;
    padding: 2px 1em 2px 1em;
    text-align: left;
}
td {
    border: 1px solid Black;
    padding: 2px 1em 2px 1em;
}
</style>

</head>
    <body onload="focus();self.name='analysis_method'" style="margin: 4px;padding:0.5em;" 
          tal:define="border_color here/base_properties/globalBorderColor;
                      is_client here/member_is_client">

        <div style="text-align:right;margin-top:1em;">
           <a href="javascript:window.close()" i18n:translate="referencebrowser_close">close window</a>
        </div>
        <h2 tal:content="here/Title">Alcohol</h2>

        <div tal:condition="not: is_client">
            <b i18n:translate="label_instructions">Instructions</b>
            <p tal:define="instructions python:here.getInstructions() or default"
               tal:content="structure python:modules['Products.PythonScripts.standard'].newline_to_br(instructions)">No instructions available</p>
        </div>
        <div tal:condition="not: is_client">
            <b i18n:translate="label_calculation">Calculation</b>
            <p tal:define="calcs python:here.getCalculationType()"
                tal:content="python:calcs and calcs.getCalculationTypeDescription() or default">No calculation</p>
        </div>
        <div> 
            <b i18n:translate="label_description">Description</b>
            <p tal:define="description python:here.getServiceDescription() or default"
               tal:content="structure python:modules['Products.PythonScripts.standard'].newline_to_br(description)">No description available</p>
        </div>

        <div tal:define="
             rc python:context.reference_catalog;
             methods python:[ref.getTargetObject() for ref in rc.getReferences(here, 'AnalysisServiceMethod')];
             sort_on python:(('Title', 'nocase', 'asc'),);
             methods python:sequence.sort(methods, sort_on)">

            <b i18n:translate="heading_methods">Methods</b>

            <table tal:condition="methods" summary="method listing"
               cellpadding="0" cellspacing="0">
            <thead>
                <tr>
                  <th i18n:translate="label_title">Title</th>
                  <th i18n:translate="label_document">Document</th>
                </tr>
            </thead>
            <tbody>
              <tal:items tal:repeat="item methods">
              <tr tal:define="doc python:item.getMethodDocument();
                              docname python:getattr(doc, 'filename', '')">
                <td tal:content="item/Title">Method</td>
                <td>
                  <a href=""  title="Click to download"
                     tal:condition=docname
                     tal:attributes="href string:${item/absolute_url}/at_download/MethodDocument"
                     tal:content=docname>Filename</a>
                </td>
              </tr>
              </tal:items>
            </tbody>
            </table>
        </div>

    </body>
</html>

